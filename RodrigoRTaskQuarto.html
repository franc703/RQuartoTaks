<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rodrigo Franco">

<title>R Interview</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="RodrigoRTaskQuarto_files/libs/clipboard/clipboard.min.js"></script>
<script src="RodrigoRTaskQuarto_files/libs/quarto-html/quarto.js"></script>
<script src="RodrigoRTaskQuarto_files/libs/quarto-html/popper.min.js"></script>
<script src="RodrigoRTaskQuarto_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="RodrigoRTaskQuarto_files/libs/quarto-html/anchor.min.js"></script>
<link href="RodrigoRTaskQuarto_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="RodrigoRTaskQuarto_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="RodrigoRTaskQuarto_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="RodrigoRTaskQuarto_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="RodrigoRTaskQuarto_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">R Interview</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rodrigo Franco </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="r-tasks---rodrigo-franco" class="level2">
<h2 class="anchored" data-anchor-id="r-tasks---rodrigo-franco">R Tasks - Rodrigo Franco</h2>
<p>This Quarto document contains my answers to the R coding interview tasks.</p>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set base URL and file tag for data access</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tag <span class="ot">&lt;-</span> <span class="st">"202311081903"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">"https://github.com/randrescastaneda/pub_data/raw/"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>data_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(base_url, tag, <span class="st">"/data/Rtest1/"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download and read the dataset</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>wdi <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(data_url, <span class="st">"wdi_in1.Rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>weighted_sd <span class="ot">&lt;-</span> <span class="cf">function</span>(x, w, <span class="at">na.rm =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(na.rm) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    na_indices <span class="ot">&lt;-</span> <span class="fu">is.na</span>(x) <span class="sc">|</span> <span class="fu">is.na</span>(w)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x[<span class="sc">!</span>na_indices]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    w <span class="ot">&lt;-</span> w[<span class="sc">!</span>na_indices]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Weighted mean</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  weighted_mean <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(x, w)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Weighted sum of squares</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  sum_w <span class="ot">&lt;-</span> <span class="fu">sum</span>(w)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  sum_xw_sq <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">*</span> (x <span class="sc">-</span> weighted_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Weighted variance for population</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  weighted_variance <span class="ot">&lt;-</span> sum_xw_sq <span class="sc">/</span> sum_w</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Weighted standard deviation is the square root of weighted variance</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  weighted_sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(weighted_variance)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(weighted_sd)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="summary-statistics-of-gdp-per-capita-by-region" class="level3">
<h3 class="anchored" data-anchor-id="summary-statistics-of-gdp-per-capita-by-region"><strong>1. Summary statistics of GDP per capita by region</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics by region and year</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> wdi <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region, date) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">n</span>(),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">weighted.mean</span>(gdp, pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">weighted_sd</span>(gdp, pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Use the weighted_sd function</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min =</span> <span class="fu">min</span>(gdp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max =</span> <span class="fu">max</span>(gdp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'region'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the summary stats</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>summary_stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 218 × 7
# Groups:   region [7]
   region               date     N  Mean    SD   Min    Max
   &lt;chr&gt;               &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 East Asia &amp; Pacific  1990    22 4913. 8497.  582. 32846.
 2 East Asia &amp; Pacific  1991    22 5105. 8691.  579. 33870.
 3 East Asia &amp; Pacific  1992    22 5291. 8667.  597. 34049.
 4 East Asia &amp; Pacific  1993    22 5483. 8576.  635. 33783.
 5 East Asia &amp; Pacific  1994    22 5740. 8619.  669. 34054.
 6 East Asia &amp; Pacific  1995    22 6037. 8796.  709. 34868.
 7 East Asia &amp; Pacific  1996    22 6340. 9011.  746. 35879.
 8 East Asia &amp; Pacific  1997    22 6538. 9045.  782. 36145.
 9 East Asia &amp; Pacific  1998    22 6449. 8823.  817. 36099.
10 East Asia &amp; Pacific  1999    22 6635. 8836.  875. 37476.
# ℹ 208 more rows</code></pre>
</div>
</div>
</section>
<section id="aggregate-stats" class="level3">
<h3 class="anchored" data-anchor-id="aggregate-stats"><strong>2. Aggregate stats</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate Stats</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the summary statistics in wide form</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>aggregate_stats_wide <span class="ot">&lt;-</span> wdi <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region, date) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">n</span>(), </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="fu">c</span>(lifeex, gdp, pov_intl),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns =</span> <span class="fu">list</span>(</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> <span class="sc">~</span> <span class="fu">weighted.mean</span>(.x, pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd =</span> <span class="sc">~</span> <span class="fu">weighted_sd</span>(.x, pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">min =</span> <span class="sc">~</span> <span class="fu">min</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">max =</span> <span class="sc">~</span> <span class="fu">max</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">.groups =</span> <span class="st">"drop"</span> <span class="co"># This drops the grouping structure after summarizing</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the wide-form summarized data to long form</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>aggregate_stats_long <span class="ot">&lt;-</span> aggregate_stats_wide <span class="sc">%&gt;%</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(region, date, N), <span class="co"># Exclude the grouping and count columns</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"variable"</span>, <span class="st">"stat"</span>), <span class="co"># Split the column names into two new columns</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span>, <span class="co"># Define the separator that splits the column names</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"value"</span> <span class="co"># The name of the column to place the values in</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 2 pieces. Additional pieces discarded in 4 rows [9, 10, 11,
12].</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the resulting long-form data frame</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>aggregate_stats_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,616 × 6
   region               date     N variable stat      value
   &lt;chr&gt;               &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;
 1 East Asia &amp; Pacific  1990    22 lifeex   mean     68.2  
 2 East Asia &amp; Pacific  1990    22 lifeex   sd        3.99 
 3 East Asia &amp; Pacific  1990    22 lifeex   min      53.7  
 4 East Asia &amp; Pacific  1990    22 lifeex   max      78.8  
 5 East Asia &amp; Pacific  1990    22 gdp      mean   4913.   
 6 East Asia &amp; Pacific  1990    22 gdp      sd     8497.   
 7 East Asia &amp; Pacific  1990    22 gdp      min     582.   
 8 East Asia &amp; Pacific  1990    22 gdp      max   32846.   
 9 East Asia &amp; Pacific  1990    22 pov      intl      0.590
10 East Asia &amp; Pacific  1990    22 pov      intl      0.254
# ℹ 2,606 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="find-outliers" class="level2">
<h2 class="anchored" data-anchor-id="find-outliers">3. Find Outliers</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the find_outliers function</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>find_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(data, variable, weight_var) {</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(region, date) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> <span class="fu">weighted.mean</span>(<span class="sc">!!</span><span class="fu">sym</span>(variable), <span class="sc">!!</span><span class="fu">sym</span>(weight_var), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> <span class="fu">weighted_sd</span>(<span class="sc">!!</span><span class="fu">sym</span>(variable), <span class="sc">!!</span><span class="fu">sym</span>(weight_var), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># Using the custom weighted_sd function</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>((<span class="sc">!!</span><span class="fu">sym</span>(variable) <span class="sc">&lt;</span> (mean <span class="sc">-</span> <span class="fl">2.5</span> <span class="sc">*</span> sd)) <span class="sc">|</span> (<span class="sc">!!</span><span class="fu">sym</span>(variable) <span class="sc">&gt;</span> (mean <span class="sc">+</span> <span class="fl">2.5</span> <span class="sc">*</span> sd)))</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Find outliers for 'lifeex', 'gdp', and 'gini'</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>outliers_lifeex <span class="ot">&lt;-</span> <span class="fu">find_outliers</span>(wdi, <span class="st">"lifeex"</span>, <span class="st">"pop"</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>outliers_gdp <span class="ot">&lt;-</span> <span class="fu">find_outliers</span>(wdi, <span class="st">"gdp"</span>, <span class="st">"pop"</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>outliers_gini <span class="ot">&lt;-</span> <span class="fu">find_outliers</span>(wdi, <span class="st">"gini"</span>, <span class="st">"pop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusting the theme to match the provided graph's aesthetics</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>custom_theme <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"transparent"</span>, <span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>), <span class="co"># Transparent background</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>), <span class="co"># Transparent panel</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="co"># Transparent legend</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Example plot for the life expectancy outliers dataset</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(outliers_lifeex, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> lifeex, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Points with some transparency</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Smoothed line with shaded confidence interval</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">custom_theme</span>() <span class="sc">+</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Life Expectancy Outliers by Region and Date"</span>,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Life Expectancy"</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"East Asia &amp; Pacific"</span> <span class="ot">=</span> <span class="st">"red"</span>,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Europe &amp; Central Asia"</span> <span class="ot">=</span> <span class="st">"gold"</span>,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Latin America &amp; Caribbean"</span> <span class="ot">=</span> <span class="st">"green"</span>,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Middle East &amp; North Africa"</span> <span class="ot">=</span> <span class="st">"blue"</span>,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"North America"</span> <span class="ot">=</span> <span class="st">"cyan"</span>,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Sub-Saharan Africa"</span> <span class="ot">=</span> <span class="st">"magenta"</span>,</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"South Asia"</span> <span class="ot">=</span> <span class="st">"orange"</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="RodrigoRTaskQuarto_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GDP Outliers Plot</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(outliers_gdp, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> gdp, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Points with some transparency</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Smoothed line with shaded confidence interval</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">custom_theme</span>() <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"GDP Outliers by Region and Date"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"GDP"</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"East Asia &amp; Pacific"</span> <span class="ot">=</span> <span class="st">"red"</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Europe &amp; Central Asia"</span> <span class="ot">=</span> <span class="st">"gold"</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Latin America &amp; Caribbean"</span> <span class="ot">=</span> <span class="st">"green"</span>,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Middle East &amp; North Africa"</span> <span class="ot">=</span> <span class="st">"blue"</span>,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"North America"</span> <span class="ot">=</span> <span class="st">"cyan"</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Sub-Saharan Africa"</span> <span class="ot">=</span> <span class="st">"magenta"</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"South Asia"</span> <span class="ot">=</span> <span class="st">"orange"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="RodrigoRTaskQuarto_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gini Coefficient Outliers Plot</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(outliers_gini, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> gini, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Points with some transparency</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Smoothed line with shaded confidence interval</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">custom_theme</span>() <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gini Coefficient Outliers by Region and Date"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gini Coefficient"</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"East Asia &amp; Pacific"</span> <span class="ot">=</span> <span class="st">"red"</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Europe &amp; Central Asia"</span> <span class="ot">=</span> <span class="st">"gold"</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Latin America &amp; Caribbean"</span> <span class="ot">=</span> <span class="st">"green"</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Middle East &amp; North Africa"</span> <span class="ot">=</span> <span class="st">"blue"</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"North America"</span> <span class="ot">=</span> <span class="st">"cyan"</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Sub-Saharan Africa"</span> <span class="ot">=</span> <span class="st">"magenta"</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"South Asia"</span> <span class="ot">=</span> <span class="st">"orange"</span>))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="RodrigoRTaskQuarto_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="poverty-measures" class="level3">
<h3 class="anchored" data-anchor-id="poverty-measures"><strong>4. Poverty measures</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Donwload the simulated data</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>l_svy <span class="ot">&lt;-</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">read_rds</span>(<span class="fu">paste0</span>(data_url, <span class="st">"svy_sim_in1.Rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cleaning-the-l_svy-data" class="level3">
<h3 class="anchored" data-anchor-id="cleaning-the-l_svy-data">Cleaning the l_svy data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the names of the list elements</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>names_list <span class="ot">&lt;-</span> <span class="fu">names</span>(l_svy)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use map2_df from purrr to iterate over the data frames and their names</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">map2_df</span>(l_svy, names_list, <span class="sc">~</span> <span class="fu">mutate</span>(.x, <span class="at">year =</span> <span class="fu">as.integer</span>(<span class="fu">sub</span>(<span class="st">"Y"</span>, <span class="st">""</span>, .y))))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 'combined_df' now has all the data combined with a 'year' variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>calculate_fgt <span class="ot">&lt;-</span> <span class="cf">function</span>(income, pov_line, weight) {</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure the data is filtered for the specific pov_line and year before passing to the function</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  headcount_ratio <span class="ot">&lt;-</span> <span class="fu">sum</span>(weight[income <span class="sc">&lt;</span> pov_line], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  povgap_ratio <span class="ot">&lt;-</span> <span class="fu">sum</span>((pov_line <span class="sc">-</span> income)[income <span class="sc">&lt;</span> pov_line] <span class="sc">*</span> weight[income <span class="sc">&lt;</span> pov_line], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                  (<span class="fu">sum</span>(weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> pov_line)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  povseverity_ratio <span class="ot">&lt;-</span> <span class="fu">sum</span>(((pov_line <span class="sc">-</span> income)<span class="sc">^</span><span class="dv">2</span>)[income <span class="sc">&lt;</span> pov_line] <span class="sc">*</span> weight[income <span class="sc">&lt;</span> pov_line], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                       (<span class="fu">sum</span>(weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> pov_line<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">headcount =</span> headcount_ratio, <span class="at">povgap =</span> povgap_ratio, <span class="at">povseverity =</span> povseverity_ratio))</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>pov_lines <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.15</span>, <span class="fl">3.65</span>, <span class="fl">6.85</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">unique</span>(combined_df<span class="sc">$</span>year)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-calculate the FGT indices for each poverty line and year combination</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>fgt_results <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">year =</span> years, <span class="at">pov_line =</span> pov_lines) <span class="sc">%&gt;%</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">headcount =</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">nrow</span>(.)),</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">povgap =</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">nrow</span>(.)),</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">povseverity =</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">nrow</span>(.))</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(fgt_results<span class="sc">$</span>year)) {</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the subset of data for the current year and poverty line</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  year_data <span class="ot">&lt;-</span> combined_df[combined_df<span class="sc">$</span>year <span class="sc">==</span> fgt_results<span class="sc">$</span>year[i], ]</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the FGT indices for the subset of data</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  fgt_values <span class="ot">&lt;-</span> <span class="fu">calculate_fgt</span>(</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">income =</span> year_data<span class="sc">$</span>income, </span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">pov_line =</span> fgt_results<span class="sc">$</span>pov_line[i], </span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> year_data<span class="sc">$</span>weight</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the results</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>  fgt_results<span class="sc">$</span>headcount[[i]] <span class="ot">&lt;-</span> fgt_values[<span class="st">"headcount"</span>]</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>  fgt_results<span class="sc">$</span>povgap[[i]] <span class="ot">&lt;-</span> fgt_values[<span class="st">"povgap"</span>]</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>  fgt_results<span class="sc">$</span>povseverity[[i]] <span class="ot">&lt;-</span> fgt_values[<span class="st">"povseverity"</span>]</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Unnest the list columns to create the final data frame</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>fgt_indices <span class="ot">&lt;-</span> fgt_results <span class="sc">%&gt;%</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(headcount, povgap, povseverity))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for the Poverty Headcount Index</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fgt_indices, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> headcount, <span class="at">color =</span> <span class="fu">factor</span>(pov_line), <span class="at">group =</span> <span class="fu">factor</span>(pov_line))) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"2.15"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"3.65"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"6.85"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Poverty Headcount Index Over Years"</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Headcount Index"</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Poverty Line"</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Poverty Line ($ per day)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RodrigoRTaskQuarto_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for the Poverty Gap Index</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fgt_indices, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> povgap, <span class="at">color =</span> <span class="fu">factor</span>(pov_line), <span class="at">group =</span> <span class="fu">factor</span>(pov_line))) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"2.15"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"3.65"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"6.85"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Poverty Gap Index Over Years"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Poverty Gap Index"</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Poverty Line"</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Poverty Line ($ per day)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RodrigoRTaskQuarto_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for the Poverty Severity Index</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fgt_indices, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> povseverity, <span class="at">color =</span> <span class="fu">factor</span>(pov_line), <span class="at">group =</span> <span class="fu">factor</span>(pov_line))) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"2.15"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"3.65"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"6.85"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Poverty Severity Index Over Years"</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Poverty Severity Index"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Poverty Line"</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Poverty Line ($ per day)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RodrigoRTaskQuarto_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="lorenz-curve" class="level2">
<h2 class="anchored" data-anchor-id="lorenz-curve">5. Lorenz Curve</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>calculate_lorenz_curve <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">income_var =</span> <span class="st">"income"</span>, <span class="at">weight_var =</span> <span class="st">"weight"</span>, <span class="at">group_var =</span> <span class="st">"year"</span>) {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize an empty data frame to store the Lorenz curve data</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  lorenz_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">bin =</span> <span class="fu">integer</span>(), </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">welfare =</span> <span class="fu">numeric</span>(), <span class="at">cum_welfare =</span> <span class="fu">numeric</span>(), <span class="at">cum_population =</span> <span class="fu">numeric</span>())</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get a vector of unique years or groups</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  groups <span class="ot">&lt;-</span> <span class="fu">unique</span>(data[[group_var]])</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the Lorenz curve for each group</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (g <span class="cf">in</span> groups) {</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter the data for the given group</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    data_group <span class="ot">&lt;-</span> data[data[[group_var]] <span class="sc">==</span> g, ]</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sort the data by income</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    sorted_data <span class="ot">&lt;-</span> data_group[<span class="fu">order</span>(data_group[[income_var]]), ]</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the cumulative welfare (income)</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    cum_welfare <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(sorted_data[[income_var]] <span class="sc">*</span> sorted_data[[weight_var]])</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    cum_welfare <span class="ot">&lt;-</span> cum_welfare <span class="sc">/</span> cum_welfare[<span class="fu">length</span>(cum_welfare)]  <span class="co"># Normalize to 1</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the cumulative population</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    cum_population <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(sorted_data[[weight_var]])</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    cum_population <span class="ot">&lt;-</span> cum_population <span class="sc">/</span> cum_population[<span class="fu">length</span>(cum_population)]  <span class="co"># Normalize to 1</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a sequence of 100 percentile bins</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    bins <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Interpolate the cumulative welfare for each bin</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>    cum_welfare_bins <span class="ot">&lt;-</span> <span class="fu">approx</span>(cum_population, cum_welfare, <span class="at">xout =</span> bins<span class="sc">/</span><span class="dv">100</span>)<span class="sc">$</span>y</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the welfare for each bin as the upper boundary of income in each percentile</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    welfare_bins <span class="ot">&lt;-</span> <span class="fu">approx</span>(cum_population, sorted_data[[income_var]], <span class="at">xout =</span> bins<span class="sc">/</span><span class="dv">100</span>)<span class="sc">$</span>y</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prepare the data frame for the current group</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>    group_lorenz_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">year =</span> g,</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">bin =</span> bins,</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">welfare =</span> welfare_bins,</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">cum_welfare =</span> cum_welfare_bins,</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">cum_population =</span> bins <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bind the group data to the main data frame</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>    lorenz_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(lorenz_data, group_lorenz_data)</span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lorenz_data)</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the function to calculate the Lorenz curve data points for each year</span></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>lorenz_curve_data <span class="ot">&lt;-</span> <span class="fu">calculate_lorenz_curve</span>(combined_df)</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>lorenz_curve_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     year bin      welfare  cum_welfare cum_population
1    2001   1   0.00000000 0.000000e+00           0.01
2    2001   2   0.00000000 0.000000e+00           0.02
3    2001   3   0.00000000 0.000000e+00           0.03
4    2001   4   0.00000000 0.000000e+00           0.04
5    2001   5   0.00000000 0.000000e+00           0.05
6    2001   6   0.00000000 0.000000e+00           0.06
7    2001   7   0.00000000 0.000000e+00           0.07
8    2001   8   0.00000000 0.000000e+00           0.08
9    2001   9   0.00000000 0.000000e+00           0.09
10   2001  10   0.00000000 0.000000e+00           0.10
11   2001  11   0.00000000 0.000000e+00           0.11
12   2001  12   0.00000000 0.000000e+00           0.12
13   2001  13   0.00000000 0.000000e+00           0.13
14   2001  14   0.00000000 0.000000e+00           0.14
15   2001  15   0.00000000 0.000000e+00           0.15
16   2001  16   0.00000000 0.000000e+00           0.16
17   2001  17   0.00000000 0.000000e+00           0.17
18   2001  18   0.00000000 0.000000e+00           0.18
19   2001  19   0.00000000 0.000000e+00           0.19
20   2001  20   0.00000000 0.000000e+00           0.20
21   2001  21   0.00000000 0.000000e+00           0.21
22   2001  22   0.00000000 0.000000e+00           0.22
23   2001  23   0.00000000 0.000000e+00           0.23
24   2001  24   0.00000000 0.000000e+00           0.24
25   2001  25   0.00000000 0.000000e+00           0.25
26   2001  26   0.00000000 0.000000e+00           0.26
27   2001  27   0.00000000 0.000000e+00           0.27
28   2001  28   0.00000000 0.000000e+00           0.28
29   2001  29   0.03604942 2.477737e-05           0.29
30   2001  30   0.10563822 1.992129e-04           0.30
31   2001  31   0.17490343 5.419569e-04           0.31
32   2001  32   0.25216422 1.066814e-03           0.32
33   2001  33   0.32358957 1.776018e-03           0.33
34   2001  34   0.39499657 2.659233e-03           0.34
35   2001  35   0.46902400 3.722053e-03           0.35
36   2001  36   0.53986756 4.959781e-03           0.36
37   2001  37   0.61801471 6.381869e-03           0.37
38   2001  38   0.69172880 7.987866e-03           0.38
39   2001  39   0.77031503 9.781644e-03           0.39
40   2001  40   0.85174932 1.177466e-02           0.40
41   2001  41   0.93623452 1.396513e-02           0.41
42   2001  42   1.01555838 1.636130e-02           0.42
43   2001  43   1.09194637 1.895008e-02           0.43
44   2001  44   1.17346052 2.172913e-02           0.44
45   2001  45   1.25629560 2.471163e-02           0.45
46   2001  46   1.34850198 2.790817e-02           0.46
47   2001  47   1.43729318 3.132989e-02           0.47
48   2001  48   1.53080280 3.497403e-02           0.48
49   2001  49   1.62489444 3.885042e-02           0.49
50   2001  50   1.72018657 4.295563e-02           0.50
51   2001  51   1.82084436 4.730144e-02           0.51
52   2001  52   1.92387638 5.189697e-02           0.52
53   2001  53   2.02868203 5.675125e-02           0.53
54   2001  54   2.12681794 6.185097e-02           0.54
55   2001  55   2.23165732 6.720185e-02           0.55
56   2001  56   2.34609016 7.281987e-02           0.56
57   2001  57   2.46852251 7.872912e-02           0.57
58   2001  58   2.58402444 8.492775e-02           0.58
59   2001  59   2.70520311 9.141633e-02           0.59
60   2001  60   2.82771638 9.821402e-02           0.60
61   2001  61   2.95205830 1.053077e-01           0.61
62   2001  62   3.08587370 1.127233e-01           0.62
63   2001  63   3.21273663 1.204521e-01           0.63
64   2001  64   3.34339380 1.284989e-01           0.64
65   2001  65   3.47171809 1.368688e-01           0.65
66   2001  66   3.63002549 1.455928e-01           0.66
67   2001  67   3.78796841 1.546932e-01           0.67
68   2001  68   3.94655205 1.641828e-01           0.68
69   2001  69   4.09836647 1.740714e-01           0.69
70   2001  70   4.25929110 1.843321e-01           0.70
71   2001  71   4.43278617 1.950015e-01           0.71
72   2001  72   4.62366268 2.061181e-01           0.72
73   2001  73   4.81152690 2.177038e-01           0.73
74   2001  74   5.01129632 2.297686e-01           0.74
75   2001  75   5.22319226 2.423345e-01           0.75
76   2001  76   5.43933561 2.554181e-01           0.76
77   2001  77   5.65717077 2.690333e-01           0.77
78   2001  78   5.91530959 2.832534e-01           0.78
79   2001  79   6.17937665 2.981086e-01           0.79
80   2001  80   6.42979829 3.135866e-01           0.80
81   2001  81   6.72820249 3.297165e-01           0.81
82   2001  82   7.04716192 3.466323e-01           0.82
83   2001  83   7.38762153 3.643446e-01           0.83
84   2001  84   7.76431014 3.829447e-01           0.84
85   2001  85   8.14610745 4.024540e-01           0.85
86   2001  86   8.53804945 4.229301e-01           0.86
87   2001  87   9.02320080 4.444665e-01           0.87
88   2001  88   9.53088688 4.672410e-01           0.88
89   2001  89  10.11241606 4.913305e-01           0.89
90   2001  90  10.73695444 5.169178e-01           0.90
91   2001  91  11.45696046 5.441741e-01           0.91
92   2001  92  12.33503161 5.733451e-01           0.92
93   2001  93  13.29805980 6.048103e-01           0.93
94   2001  94  14.43474245 6.388792e-01           0.94
95   2001  95  15.95100746 6.762399e-01           0.95
96   2001  96  18.01247138 7.177737e-01           0.96
97   2001  97  20.43642104 7.648454e-01           0.97
98   2001  98  24.40885257 8.195420e-01           0.98
99   2001  99  32.33568274 8.880067e-01           0.99
100  2001 100 249.21168591 1.000000e+00           1.00
101  2002   1   0.00000000 0.000000e+00           0.01
102  2002   2   0.00000000 0.000000e+00           0.02
103  2002   3   0.00000000 0.000000e+00           0.03
104  2002   4   0.00000000 0.000000e+00           0.04
105  2002   5   0.00000000 0.000000e+00           0.05
106  2002   6   0.00000000 0.000000e+00           0.06
107  2002   7   0.00000000 0.000000e+00           0.07
108  2002   8   0.00000000 0.000000e+00           0.08
109  2002   9   0.00000000 0.000000e+00           0.09
110  2002  10   0.00000000 0.000000e+00           0.10
111  2002  11   0.00000000 0.000000e+00           0.11
112  2002  12   0.00000000 0.000000e+00           0.12
113  2002  13   0.00000000 0.000000e+00           0.13
114  2002  14   0.00000000 0.000000e+00           0.14
115  2002  15   0.00000000 0.000000e+00           0.15
116  2002  16   0.00000000 0.000000e+00           0.16
117  2002  17   0.00000000 0.000000e+00           0.17
118  2002  18   0.00000000 0.000000e+00           0.18
119  2002  19   0.00000000 0.000000e+00           0.19
120  2002  20   0.00000000 0.000000e+00           0.20
121  2002  21   0.01175004 2.356999e-06           0.21
122  2002  22   0.07655763 1.042029e-04           0.22
123  2002  23   0.14113017 3.599981e-04           0.23
124  2002  24   0.20688974 7.648383e-04           0.24
125  2002  25   0.27215975 1.319991e-03           0.25
126  2002  26   0.33521913 2.022501e-03           0.26
127  2002  27   0.40329810 2.879045e-03           0.27
128  2002  28   0.47146638 3.892763e-03           0.28
129  2002  29   0.53901083 5.066284e-03           0.29
130  2002  30   0.60502885 6.394977e-03           0.30
131  2002  31   0.67537241 7.879402e-03           0.31
132  2002  32   0.74576480 9.527811e-03           0.32
133  2002  33   0.81821949 1.134124e-02           0.33
134  2002  34   0.89057576 1.332193e-02           0.34
135  2002  35   0.96675286 1.547422e-02           0.35
136  2002  36   1.04117183 1.780123e-02           0.36
137  2002  37   1.11010582 2.029710e-02           0.37
138  2002  38   1.18645495 2.296381e-02           0.38
139  2002  39   1.25945290 2.580320e-02           0.39
140  2002  40   1.33674365 2.881130e-02           0.40
141  2002  41   1.41132092 3.200097e-02           0.41
142  2002  42   1.49058726 3.536404e-02           0.42
143  2002  43   1.56920150 3.891180e-02           0.43
144  2002  44   1.65053352 4.264296e-02           0.44
145  2002  45   1.73204545 4.656665e-02           0.45
146  2002  46   1.81780197 5.068250e-02           0.46
147  2002  47   1.90478725 5.500149e-02           0.47
148  2002  48   1.99024568 5.952005e-02           0.48
149  2002  49   2.07965088 6.424146e-02           0.49
150  2002  50   2.16956220 6.916803e-02           0.50
151  2002  51   2.26291654 7.430381e-02           0.51
152  2002  52   2.36217437 7.966850e-02           0.52
153  2002  53   2.46245989 8.526396e-02           0.53
154  2002  54   2.56170415 9.109254e-02           0.54
155  2002  55   2.66699166 9.715278e-02           0.55
156  2002  56   2.76493360 1.034466e-01           0.56
157  2002  57   2.87724038 1.099890e-01           0.57
158  2002  58   2.98120119 1.167886e-01           0.58
159  2002  59   3.09720439 1.238349e-01           0.59
160  2002  60   3.22511446 1.311631e-01           0.60
161  2002  61   3.34836935 1.387832e-01           0.61
162  2002  62   3.47507879 1.467001e-01           0.62
163  2002  63   3.61196743 1.549130e-01           0.63
164  2002  64   3.74835521 1.634500e-01           0.64
165  2002  65   3.87567618 1.722889e-01           0.65
166  2002  66   4.01884520 1.814438e-01           0.66
167  2002  67   4.17090419 1.909392e-01           0.67
168  2002  68   4.32469222 2.007884e-01           0.68
169  2002  69   4.48062941 2.110081e-01           0.69
170  2002  70   4.66199146 2.216153e-01           0.70
171  2002  71   4.85523112 2.326530e-01           0.71
172  2002  72   5.04980181 2.441391e-01           0.72
173  2002  73   5.23724291 2.560683e-01           0.73
174  2002  74   5.44654191 2.684461e-01           0.74
175  2002  75   5.64860663 2.813094e-01           0.75
176  2002  76   5.87090567 2.946739e-01           0.76
177  2002  77   6.08610993 3.085363e-01           0.77
178  2002  78   6.34080179 3.229429e-01           0.78
179  2002  79   6.60657197 3.379538e-01           0.79
180  2002  80   6.88428472 3.536091e-01           0.80
181  2002  81   7.16663362 3.698992e-01           0.81
182  2002  82   7.48984983 3.868895e-01           0.82
183  2002  83   7.81639747 4.046242e-01           0.83
184  2002  84   8.16598782 4.231539e-01           0.84
185  2002  85   8.52736755 4.425260e-01           0.85
186  2002  86   8.91640289 4.627603e-01           0.86
187  2002  87   9.32774613 4.839223e-01           0.87
188  2002  88   9.79353405 5.060899e-01           0.88
189  2002  89  10.35251970 5.294392e-01           0.89
190  2002  90  10.93919838 5.541023e-01           0.90
191  2002  91  11.58261317 5.802097e-01           0.91
192  2002  92  12.39012247 6.079970e-01           0.92
193  2002  93  13.24246372 6.376678e-01           0.93
194  2002  94  14.29218258 6.695904e-01           0.94
195  2002  95  15.64698917 7.041629e-01           0.95
196  2002  96  17.52846464 7.425509e-01           0.96
197  2002  97  19.78795304 7.856542e-01           0.97
198  2002  98  23.50480406 8.356116e-01           0.98
199  2002  99  30.26139622 8.972718e-01           0.99
200  2002 100 132.06588914 1.000000e+00           1.00
201  2003   1   0.00000000 0.000000e+00           0.01
202  2003   2   0.00000000 0.000000e+00           0.02
203  2003   3   0.00000000 0.000000e+00           0.03
204  2003   4   0.00000000 0.000000e+00           0.04
205  2003   5   0.00000000 0.000000e+00           0.05
206  2003   6   0.00000000 0.000000e+00           0.06
207  2003   7   0.00000000 0.000000e+00           0.07
208  2003   8   0.00000000 0.000000e+00           0.08
209  2003   9   0.00000000 0.000000e+00           0.09
210  2003  10   0.00000000 0.000000e+00           0.10
211  2003  11   0.00000000 0.000000e+00           0.11
212  2003  12   0.00000000 0.000000e+00           0.12
213  2003  13   0.01708271 4.878584e-06           0.13
214  2003  14   0.08056925 1.129850e-04           0.14
215  2003  15   0.14307817 3.612079e-04           0.15
216  2003  16   0.20793604 7.485179e-04           0.16
217  2003  17   0.26976657 1.279085e-03           0.17
218  2003  18   0.33461624 1.946182e-03           0.18
219  2003  19   0.39407474 2.752337e-03           0.19
220  2003  20   0.45423710 3.687936e-03           0.20
221  2003  21   0.51515600 4.760532e-03           0.21
222  2003  22   0.57797664 5.966396e-03           0.22
223  2003  23   0.64064351 7.309955e-03           0.23
224  2003  24   0.69838776 8.788995e-03           0.24
225  2003  25   0.76010387 1.040165e-02           0.25
226  2003  26   0.82558616 1.215617e-02           0.26
227  2003  27   0.89034738 1.405153e-02           0.27
228  2003  28   0.95351265 1.608818e-02           0.28
229  2003  29   1.01417505 1.826491e-02           0.29
230  2003  30   1.07807589 2.057679e-02           0.30
231  2003  31   1.14402486 2.303413e-02           0.31
232  2003  32   1.21308517 2.563887e-02           0.32
233  2003  33   1.27587102 2.839208e-02           0.33
234  2003  34   1.34852957 3.129230e-02           0.34
235  2003  35   1.41570017 3.434779e-02           0.35
236  2003  36   1.48859289 3.755738e-02           0.36
237  2003  37   1.56041946 4.092563e-02           0.37
238  2003  38   1.63052847 4.445269e-02           0.38
239  2003  39   1.70562505 4.813966e-02           0.39
240  2003  40   1.77628876 5.199013e-02           0.40
241  2003  41   1.85150920 5.600085e-02           0.41
242  2003  42   1.92275197 6.017045e-02           0.42
243  2003  43   1.99928628 6.450618e-02           0.43
244  2003  44   2.07925727 6.901560e-02           0.44
245  2003  45   2.15404848 7.369571e-02           0.45
246  2003  46   2.23573642 7.855233e-02           0.46
247  2003  47   2.32183678 8.359102e-02           0.47
248  2003  48   2.40487270 8.881631e-02           0.48
249  2003  49   2.49392740 9.423432e-02           0.49
250  2003  50   2.57818412 9.984065e-02           0.50
251  2003  51   2.66531141 1.056389e-01           0.51
252  2003  52   2.75259203 1.116252e-01           0.52
253  2003  53   2.84396903 1.178122e-01           0.53
254  2003  54   2.94320835 1.242101e-01           0.54
255  2003  55   3.03838085 1.308222e-01           0.55
256  2003  56   3.13994496 1.376543e-01           0.56
257  2003  57   3.24591866 1.447135e-01           0.57
258  2003  58   3.35162112 1.520020e-01           0.58
259  2003  59   3.46049156 1.595364e-01           0.59
260  2003  60   3.57909890 1.673197e-01           0.60
261  2003  61   3.69401811 1.753616e-01           0.61
262  2003  62   3.81551101 1.836641e-01           0.62
263  2003  63   3.94945473 1.922508e-01           0.63
264  2003  64   4.07624599 2.011197e-01           0.64
265  2003  65   4.21390642 2.102823e-01           0.65
266  2003  66   4.33819501 2.197327e-01           0.66
267  2003  67   4.47970174 2.294878e-01           0.67
268  2003  68   4.61846826 2.395433e-01           0.68
269  2003  69   4.76159478 2.499133e-01           0.69
270  2003  70   4.91782352 2.606100e-01           0.70
271  2003  71   5.07133290 2.716587e-01           0.71
272  2003  72   5.25132490 2.830702e-01           0.72
273  2003  73   5.42706528 2.948781e-01           0.73
274  2003  74   5.63624814 3.071052e-01           0.74
275  2003  75   5.83767306 3.197897e-01           0.75
276  2003  76   6.05293856 3.329408e-01           0.76
277  2003  77   6.26742340 3.465602e-01           0.77
278  2003  78   6.49305144 3.606662e-01           0.78
279  2003  79   6.73832794 3.752923e-01           0.79
280  2003  80   6.99460512 3.904531e-01           0.80
281  2003  81   7.27380453 4.062271e-01           0.81
282  2003  82   7.57924828 4.226399e-01           0.82
283  2003  83   7.89499647 4.397410e-01           0.83
284  2003  84   8.22719770 4.575779e-01           0.84
285  2003  85   8.59482740 4.761697e-01           0.85
286  2003  86   9.00111768 4.956415e-01           0.86
287  2003  87   9.40539284 5.159942e-01           0.87
288  2003  88   9.86017233 5.372846e-01           0.88
289  2003  89  10.36660819 5.596551e-01           0.89
290  2003  90  10.94448593 5.832283e-01           0.90
291  2003  91  11.60578151 6.081668e-01           0.91
292  2003  92  12.35668678 6.346420e-01           0.92
293  2003  93  13.22962382 6.628951e-01           0.93
294  2003  94  14.23778802 6.932142e-01           0.94
295  2003  95  15.43488611 7.260275e-01           0.95
296  2003  96  17.00314980 7.618727e-01           0.96
297  2003  97  19.53321510 8.021145e-01           0.97
298  2003  98  23.35567998 8.492112e-01           0.98
299  2003  99  29.53523931 9.068481e-01           0.99
300  2003 100 164.40990379 1.000000e+00           1.00
301  2004   1   0.00000000 0.000000e+00           0.01
302  2004   2   0.00000000 0.000000e+00           0.02
303  2004   3   0.00000000 0.000000e+00           0.03
304  2004   4   0.00000000 0.000000e+00           0.04
305  2004   5   0.02080658 5.922734e-06           0.05
306  2004   6   0.10081345 1.338716e-04           0.06
307  2004   7   0.17478297 4.221663e-04           0.07
308  2004   8   0.24584376 8.623166e-04           0.08
309  2004   9   0.31190210 1.445347e-03           0.09
310  2004  10   0.37595406 2.164490e-03           0.10
311  2004  11   0.44139832 3.017224e-03           0.11
312  2004  12   0.50321284 4.004338e-03           0.12
313  2004  13   0.56673035 5.121800e-03           0.13
314  2004  14   0.62663256 6.367300e-03           0.14
315  2004  15   0.68593176 7.736711e-03           0.15
316  2004  16   0.74494128 9.228028e-03           0.16
317  2004  17   0.80279708 1.084323e-02           0.17
318  2004  18   0.85933966 1.257828e-02           0.18
319  2004  19   0.91737289 1.443091e-02           0.19
320  2004  20   0.97859784 1.640849e-02           0.20
321  2004  21   1.03496816 1.851009e-02           0.21
322  2004  22   1.09606307 2.073479e-02           0.22
323  2004  23   1.15366486 2.308133e-02           0.23
324  2004  24   1.21466641 2.555103e-02           0.24
325  2004  25   1.27227913 2.814452e-02           0.25
326  2004  26   1.33227094 3.086172e-02           0.26
327  2004  27   1.39046473 3.370296e-02           0.27
328  2004  28   1.45372960 3.666966e-02           0.28
329  2004  29   1.51661459 3.976670e-02           0.29
330  2004  30   1.57718649 4.299365e-02           0.30
331  2004  31   1.63749875 4.634767e-02           0.31
332  2004  32   1.69772508 4.982663e-02           0.32
333  2004  33   1.76216419 5.343671e-02           0.33
334  2004  34   1.82628698 5.718312e-02           0.34
335  2004  35   1.89150345 6.106241e-02           0.35
336  2004  36   1.95550555 6.507397e-02           0.36
337  2004  37   2.02290857 6.922384e-02           0.37
338  2004  38   2.08761404 7.351236e-02           0.38
339  2004  39   2.15561096 7.794032e-02           0.39
340  2004  40   2.22173457 8.250597e-02           0.40
341  2004  41   2.29368652 8.721652e-02           0.41
342  2004  42   2.36381701 9.207394e-02           0.42
343  2004  43   2.43737049 9.708342e-02           0.43
344  2004  44   2.51573578 1.022528e-01           0.44
345  2004  45   2.59202040 1.075820e-01           0.45
346  2004  46   2.67543773 1.130784e-01           0.46
347  2004  47   2.75017231 1.187397e-01           0.47
348  2004  48   2.82913330 1.245615e-01           0.48
349  2004  49   2.91001533 1.305466e-01           0.49
350  2004  50   2.99382376 1.367023e-01           0.50
351  2004  51   3.08077632 1.430389e-01           0.51
352  2004  52   3.16388571 1.495526e-01           0.52
353  2004  53   3.25785076 1.562517e-01           0.53
354  2004  54   3.34561470 1.631365e-01           0.54
355  2004  55   3.44169286 1.702138e-01           0.55
356  2004  56   3.53542358 1.774957e-01           0.56
357  2004  57   3.63691692 1.849770e-01           0.57
358  2004  58   3.73761494 1.926741e-01           0.58
359  2004  59   3.84512361 2.005864e-01           0.59
360  2004  60   3.94634185 2.087185e-01           0.60
361  2004  61   4.05701187 2.170680e-01           0.61
362  2004  62   4.17916974 2.256631e-01           0.62
363  2004  63   4.29616183 2.345039e-01           0.63
364  2004  64   4.42370210 2.435978e-01           0.64
365  2004  65   4.54540553 2.529513e-01           0.65
366  2004  66   4.67620983 2.625781e-01           0.66
367  2004  67   4.80160376 2.724717e-01           0.67
368  2004  68   4.94633546 2.826359e-01           0.68
369  2004  69   5.08646874 2.931056e-01           0.69
370  2004  70   5.24163287 3.038825e-01           0.70
371  2004  71   5.40259300 3.149901e-01           0.71
372  2004  72   5.56103510 3.264240e-01           0.72
373  2004  73   5.71860800 3.381852e-01           0.73
374  2004  74   5.90525668 3.503038e-01           0.74
375  2004  75   6.10811526 3.628397e-01           0.75
376  2004  76   6.30909580 3.757924e-01           0.76
377  2004  77   6.50036047 3.891586e-01           0.77
378  2004  78   6.70570871 4.029397e-01           0.78
379  2004  79   6.93576243 4.171733e-01           0.79
380  2004  80   7.16112962 4.318788e-01           0.80
381  2004  81   7.42758666 4.470936e-01           0.81
382  2004  82   7.69235811 4.628638e-01           0.82
383  2004  83   7.97634277 4.792068e-01           0.83
384  2004  84   8.27386958 4.961455e-01           0.84
385  2004  85   8.62640800 5.137669e-01           0.85
386  2004  86   8.96946035 5.321225e-01           0.86
387  2004  87   9.35276602 5.512310e-01           0.87
388  2004  88   9.80609314 5.712202e-01           0.88
389  2004  89  10.27494975 5.921471e-01           0.89
390  2004  90  10.85614200 6.141668e-01           0.90
391  2004  91  11.48597194 6.374817e-01           0.91
392  2004  92  12.21234803 6.621609e-01           0.92
393  2004  93  13.12272875 6.885439e-01           0.93
394  2004  94  14.08755442 7.169116e-01           0.94
395  2004  95  15.30030114 7.475458e-01           0.95
396  2004  96  16.84909829 7.809553e-01           0.96
397  2004  97  19.06665515 8.182581e-01           0.97
398  2004  98  22.16919497 8.610269e-01           0.98
399  2004  99  28.93734633 9.132678e-01           0.99
400  2004 100 135.18267712 1.000000e+00           1.00
401  2005   1   0.21450789 2.066320e-04           0.01
402  2005   2   0.35211148 7.727074e-04           0.02
403  2005   3   0.45225218 1.568355e-03           0.03
404  2005   4   0.54089415 2.550001e-03           0.04
405  2005   5   0.61891776 3.693321e-03           0.05
406  2005   6   0.69088875 4.985387e-03           0.06
407  2005   7   0.75830979 6.413015e-03           0.07
408  2005   8   0.82477983 7.972898e-03           0.08
409  2005   9   0.88770776 9.660674e-03           0.09
410  2005  10   0.95027080 1.146880e-02           0.10
411  2005  11   1.00557077 1.339484e-02           0.11
412  2005  12   1.05888300 1.542719e-02           0.12
413  2005  13   1.11778434 1.757065e-02           0.13
414  2005  14   1.17038650 1.982393e-02           0.14
415  2005  15   1.22542619 2.218209e-02           0.15
416  2005  16   1.27865479 2.464780e-02           0.16
417  2005  17   1.33458189 2.722152e-02           0.17
418  2005  18   1.38967831 2.990602e-02           0.18
419  2005  19   1.44462202 3.269535e-02           0.19
420  2005  20   1.49783681 3.559467e-02           0.20
421  2005  21   1.54849441 3.859437e-02           0.21
422  2005  22   1.60391795 4.170063e-02           0.22
423  2005  23   1.65747368 4.491340e-02           0.23
424  2005  24   1.71336080 4.823169e-02           0.24
425  2005  25   1.76724333 5.165872e-02           0.25
426  2005  26   1.82023895 5.519170e-02           0.26
427  2005  27   1.87307065 5.882965e-02           0.27
428  2005  28   1.92797454 6.257145e-02           0.28
429  2005  29   1.98341504 6.642259e-02           0.29
430  2005  30   2.03977392 7.038348e-02           0.30
431  2005  31   2.09785273 7.445869e-02           0.31
432  2005  32   2.15454905 7.864674e-02           0.32
433  2005  33   2.21507979 8.295017e-02           0.33
434  2005  34   2.27117875 8.736741e-02           0.34
435  2005  35   2.33007283 9.189537e-02           0.35
436  2005  36   2.39188989 9.654509e-02           0.36
437  2005  37   2.44961547 1.013129e-01           0.37
438  2005  38   2.51073796 1.061987e-01           0.38
439  2005  39   2.57548632 1.112068e-01           0.39
440  2005  40   2.64103358 1.163430e-01           0.40
441  2005  41   2.70632913 1.216085e-01           0.41
442  2005  42   2.77252480 1.270053e-01           0.42
443  2005  43   2.84003047 1.325315e-01           0.43
444  2005  44   2.90662546 1.381884e-01           0.44
445  2005  45   2.98357545 1.439874e-01           0.45
446  2005  46   3.06179299 1.499418e-01           0.46
447  2005  47   3.12924529 1.560381e-01           0.47
448  2005  48   3.20393433 1.622776e-01           0.48
449  2005  49   3.28704580 1.686675e-01           0.49
450  2005  50   3.35826451 1.752122e-01           0.50
451  2005  51   3.43697679 1.819051e-01           0.51
452  2005  52   3.51620624 1.887528e-01           0.52
453  2005  53   3.60107113 1.957598e-01           0.53
454  2005  54   3.68785832 2.029368e-01           0.54
455  2005  55   3.77590906 2.102815e-01           0.55
456  2005  56   3.87021590 2.178149e-01           0.56
457  2005  57   3.96148302 2.255240e-01           0.57
458  2005  58   4.05816092 2.334223e-01           0.58
459  2005  59   4.15208658 2.415087e-01           0.59
460  2005  60   4.25008346 2.497810e-01           0.60
461  2005  61   4.35032908 2.582459e-01           0.61
462  2005  62   4.45565941 2.669170e-01           0.62
463  2005  63   4.57090307 2.758041e-01           0.63
464  2005  64   4.68884733 2.849266e-01           0.64
465  2005  65   4.80301433 2.942675e-01           0.65
466  2005  66   4.92001214 3.038454e-01           0.66
467  2005  67   5.03579582 3.136496e-01           0.67
468  2005  68   5.16887320 3.236994e-01           0.68
469  2005  69   5.29496811 3.340056e-01           0.69
470  2005  70   5.43446796 3.445671e-01           0.70
471  2005  71   5.57164960 3.553961e-01           0.71
472  2005  72   5.72141000 3.665132e-01           0.72
473  2005  73   5.88451059 3.779399e-01           0.73
474  2005  74   6.06590181 3.897096e-01           0.74
475  2005  75   6.23602377 4.018221e-01           0.75
476  2005  76   6.42688622 4.142865e-01           0.76
477  2005  77   6.61968734 4.271296e-01           0.77
478  2005  78   6.82991085 4.403744e-01           0.78
479  2005  79   7.05741326 4.540422e-01           0.79
480  2005  80   7.28194405 4.681630e-01           0.80
481  2005  81   7.53579554 4.827445e-01           0.81
482  2005  82   7.81284975 4.978541e-01           0.82
483  2005  83   8.08860424 5.135241e-01           0.83
484  2005  84   8.37021110 5.297311e-01           0.84
485  2005  85   8.67931027 5.465266e-01           0.85
486  2005  86   9.05556103 5.639910e-01           0.86
487  2005  87   9.41884084 5.821779e-01           0.87
488  2005  88   9.84286089 6.011503e-01           0.88
489  2005  89  10.28249712 6.209738e-01           0.89
490  2005  90  10.81905020 6.417572e-01           0.90
491  2005  91  11.41836230 6.636519e-01           0.91
492  2005  92  12.14779986 6.868746e-01           0.92
493  2005  93  12.93581856 7.115232e-01           0.93
494  2005  94  13.92039122 7.379431e-01           0.94
495  2005  95  15.19060516 7.665673e-01           0.95
496  2005  96  16.74377733 7.978729e-01           0.96
497  2005  97  18.50789548 8.324978e-01           0.97
498  2005  98  21.83755591 8.718224e-01           0.98
499  2005  99  28.16983430 9.204603e-01           0.99
500  2005 100 102.16975274 1.000000e+00           1.00
501  2006   1   0.80531110 1.286136e-03           0.01
502  2006   2   0.93284470 2.906460e-03           0.02
503  2006   3   1.02926459 4.729796e-03           0.03
504  2006   4   1.11368066 6.720077e-03           0.04
505  2006   5   1.19148083 8.858351e-03           0.05
506  2006   6   1.25938001 1.113124e-02           0.06
507  2006   7   1.32307379 1.352756e-02           0.07
508  2006   8   1.38494496 1.603879e-02           0.08
509  2006   9   1.44056519 1.866045e-02           0.09
510  2006  10   1.49525056 2.138233e-02           0.10
511  2006  11   1.54898963 2.420513e-02           0.11
512  2006  12   1.60255010 2.712858e-02           0.12
513  2006  13   1.65464751 3.014905e-02           0.13
514  2006  14   1.70697219 3.326562e-02           0.14
515  2006  15   1.75906333 3.647972e-02           0.15
516  2006  16   1.80973213 3.978963e-02           0.16
517  2006  17   1.86082345 4.319313e-02           0.17
518  2006  18   1.91198047 4.669219e-02           0.18
519  2006  19   1.96294751 5.028589e-02           0.19
520  2006  20   2.01235213 5.397255e-02           0.20
521  2006  21   2.06168175 5.775019e-02           0.21
522  2006  22   2.11443856 6.162270e-02           0.22
523  2006  23   2.16522929 6.559142e-02           0.23
524  2006  24   2.21746628 6.965438e-02           0.24
525  2006  25   2.27150586 7.381746e-02           0.25
526  2006  26   2.32524639 7.807925e-02           0.26
527  2006  27   2.37846097 8.244115e-02           0.27
528  2006  28   2.43130973 8.690098e-02           0.28
529  2006  29   2.48333266 9.145802e-02           0.29
530  2006  30   2.53808301 9.611549e-02           0.30
531  2006  31   2.59316771 1.008754e-01           0.31
532  2006  32   2.64815717 1.057369e-01           0.32
533  2006  33   2.70367422 1.106998e-01           0.33
534  2006  34   2.75991508 1.157671e-01           0.34
535  2006  35   2.81795245 1.209396e-01           0.35
536  2006  36   2.86968373 1.262139e-01           0.36
537  2006  37   2.92840217 1.315925e-01           0.37
538  2006  38   2.98703560 1.370781e-01           0.38
539  2006  39   3.04859726 1.426760e-01           0.39
540  2006  40   3.11132725 1.483893e-01           0.40
541  2006  41   3.17474765 1.542180e-01           0.41
542  2006  42   3.23742016 1.601633e-01           0.42
543  2006  43   3.29965738 1.662235e-01           0.43
544  2006  44   3.36144987 1.724012e-01           0.44
545  2006  45   3.42692757 1.786984e-01           0.45
546  2006  46   3.49775191 1.851203e-01           0.46
547  2006  47   3.56916165 1.916750e-01           0.47
548  2006  48   3.63669067 1.983584e-01           0.48
549  2006  49   3.70383144 2.051666e-01           0.49
550  2006  50   3.77405812 2.121014e-01           0.50
551  2006  51   3.85191959 2.191719e-01           0.51
552  2006  52   3.93093029 2.263882e-01           0.52
553  2006  53   4.01066520 2.337537e-01           0.53
554  2006  54   4.09179910 2.412679e-01           0.54
555  2006  55   4.17358891 2.489327e-01           0.55
556  2006  56   4.25456361 2.567472e-01           0.56
557  2006  57   4.33959865 2.647193e-01           0.57
558  2006  58   4.43167491 2.728522e-01           0.58
559  2006  59   4.51891661 2.811548e-01           0.59
560  2006  60   4.61780170 2.896279e-01           0.60
561  2006  61   4.71299637 2.982800e-01           0.61
562  2006  62   4.80610787 3.071039e-01           0.62
563  2006  63   4.90756951 3.161108e-01           0.63
564  2006  64   5.01421094 3.253089e-01           0.64
565  2006  65   5.12740028 3.347134e-01           0.65
566  2006  66   5.23319490 3.443140e-01           0.66
567  2006  67   5.34781493 3.541261e-01           0.67
568  2006  68   5.47506328 3.641620e-01           0.68
569  2006  69   5.60646855 3.744407e-01           0.69
570  2006  70   5.73986530 3.849667e-01           0.70
571  2006  71   5.87694907 3.957429e-01           0.71
572  2006  72   6.01934414 4.067739e-01           0.72
573  2006  73   6.17612244 4.180812e-01           0.73
574  2006  74   6.33177754 4.296828e-01           0.74
575  2006  75   6.49186347 4.415783e-01           0.75
576  2006  76   6.67904157 4.537892e-01           0.76
577  2006  77   6.86964636 4.663522e-01           0.77
578  2006  78   7.05977681 4.792645e-01           0.78
579  2006  79   7.25449256 4.925335e-01           0.79
580  2006  80   7.46866942 5.061825e-01           0.80
581  2006  81   7.68918675 5.202411e-01           0.81
582  2006  82   7.94536987 5.347300e-01           0.82
583  2006  83   8.22143877 5.497194e-01           0.83
584  2006  84   8.48947956 5.652200e-01           0.84
585  2006  85   8.76405562 5.812182e-01           0.85
586  2006  86   9.09998229 5.977882e-01           0.86
587  2006  87   9.44789558 6.149923e-01           0.87
588  2006  88   9.87647635 6.329142e-01           0.88
589  2006  89  10.33222331 6.516450e-01           0.89
590  2006  90  10.82708628 6.712794e-01           0.90
591  2006  91  11.40981222 6.918934e-01           0.91
592  2006  92  12.05177378 7.136305e-01           0.92
593  2006  93  12.77354931 7.366179e-01           0.93
594  2006  94  13.71717182 7.611680e-01           0.94
595  2006  95  14.83401151 7.875872e-01           0.95
596  2006  96  16.25406282 8.164307e-01           0.96
597  2006  97  18.35948319 8.483685e-01           0.97
598  2006  98  21.21754510 8.850621e-01           0.98
599  2006  99  26.72505602 9.289180e-01           0.99
600  2006 100 176.00784403 1.000000e+00           1.00
601  2007   1   1.38195273 2.231073e-03           0.01
602  2007   2   1.50077546 4.761133e-03           0.02
603  2007   3   1.59034935 7.469432e-03           0.03
604  2007   4   1.66794014 1.032219e-02           0.04
605  2007   5   1.73678483 1.330261e-02           0.05
606  2007   6   1.80169315 1.640054e-02           0.06
607  2007   7   1.86082310 1.960691e-02           0.07
608  2007   8   1.92071601 2.291660e-02           0.08
609  2007   9   1.97464039 2.632637e-02           0.09
610  2007  10   2.02906889 2.983052e-02           0.10
611  2007  11   2.08099284 3.342694e-02           0.11
612  2007  12   2.13017990 3.711219e-02           0.12
613  2007  13   2.18455584 4.088795e-02           0.13
614  2007  14   2.23165108 4.475343e-02           0.14
615  2007  15   2.28216545 4.870361e-02           0.15
616  2007  16   2.33128567 5.274141e-02           0.16
617  2007  17   2.37930651 5.686383e-02           0.17
618  2007  18   2.42912488 6.107202e-02           0.18
619  2007  19   2.47694299 6.536727e-02           0.19
620  2007  20   2.52400039 6.974411e-02           0.20
621  2007  21   2.57227247 7.420411e-02           0.21
622  2007  22   2.61896980 7.874799e-02           0.22
623  2007  23   2.66631828 8.337320e-02           0.23
624  2007  24   2.71413907 8.808187e-02           0.24
625  2007  25   2.76184110 9.287409e-02           0.25
626  2007  26   2.81142451 9.775089e-02           0.26
627  2007  27   2.86206047 1.027159e-01           0.27
628  2007  28   2.91105311 1.077674e-01           0.28
629  2007  29   2.96199717 1.129088e-01           0.29
630  2007  30   3.01160193 1.181370e-01           0.30
631  2007  31   3.06450193 1.234543e-01           0.31
632  2007  32   3.11510510 1.288642e-01           0.32
633  2007  33   3.16626432 1.343626e-01           0.33
634  2007  34   3.21804556 1.399500e-01           0.34
635  2007  35   3.26957044 1.456285e-01           0.35
636  2007  36   3.32526256 1.514003e-01           0.36
637  2007  37   3.37835043 1.572678e-01           0.37
638  2007  38   3.43538534 1.632312e-01           0.38
639  2007  39   3.49187694 1.692940e-01           0.39
640  2007  40   3.55181216 1.754600e-01           0.40
641  2007  41   3.60486191 1.817232e-01           0.41
642  2007  42   3.66254178 1.880828e-01           0.42
643  2007  43   3.72495970 1.945481e-01           0.43
644  2007  44   3.78529923 2.011220e-01           0.44
645  2007  45   3.84684622 2.078003e-01           0.45
646  2007  46   3.91276279 2.145946e-01           0.46
647  2007  47   3.97815490 2.215013e-01           0.47
648  2007  48   4.04308607 2.285242e-01           0.48
649  2007  49   4.10910929 2.356602e-01           0.49
650  2007  50   4.17474512 2.429096e-01           0.50
651  2007  51   4.24464960 2.502783e-01           0.51
652  2007  52   4.31692417 2.577724e-01           0.52
653  2007  53   4.38939005 2.653949e-01           0.53
654  2007  54   4.46592586 2.731451e-01           0.54
655  2007  55   4.54463566 2.810330e-01           0.55
656  2007  56   4.62254529 2.890575e-01           0.56
657  2007  57   4.70841969 2.972240e-01           0.57
658  2007  58   4.79059172 3.055379e-01           0.58
659  2007  59   4.87194230 3.139942e-01           0.59
660  2007  60   4.96393720 3.226019e-01           0.60
661  2007  61   5.05923356 3.313692e-01           0.61
662  2007  62   5.15667364 3.403097e-01           0.62
663  2007  63   5.25154879 3.494159e-01           0.63
664  2007  64   5.34521621 3.586871e-01           0.64
665  2007  65   5.45446955 3.681388e-01           0.65
666  2007  66   5.56364352 3.777854e-01           0.66
667  2007  67   5.67570381 3.876259e-01           0.67
668  2007  68   5.78694448 3.976576e-01           0.68
669  2007  69   5.91593147 4.078991e-01           0.69
670  2007  70   6.04136163 4.183632e-01           0.70
671  2007  71   6.17133490 4.290504e-01           0.71
672  2007  72   6.30128983 4.399670e-01           0.72
673  2007  73   6.44216931 4.511173e-01           0.73
674  2007  74   6.58279640 4.625215e-01           0.74
675  2007  75   6.73267671 4.741764e-01           0.75
676  2007  76   6.89250110 4.861027e-01           0.76
677  2007  77   7.05722157 4.983136e-01           0.77
678  2007  78   7.22674499 5.108140e-01           0.78
679  2007  79   7.42134103 5.236284e-01           0.79
680  2007  80   7.62290736 5.367932e-01           0.80
681  2007  81   7.85749387 5.503432e-01           0.81
682  2007  82   8.09966739 5.643089e-01           0.82
683  2007  83   8.34981934 5.786953e-01           0.83
684  2007  84   8.60236484 5.935340e-01           0.84
685  2007  85   8.90180637 6.088512e-01           0.85
686  2007  86   9.23515801 6.247320e-01           0.86
687  2007  87   9.60394559 6.412120e-01           0.87
688  2007  88  10.00577146 6.583781e-01           0.88
689  2007  89  10.43662434 6.762687e-01           0.89
690  2007  90  10.92635435 6.949659e-01           0.90
691  2007  91  11.43530388 7.145083e-01           0.91
692  2007  92  12.05077924 7.350653e-01           0.92
693  2007  93  12.79185644 7.568199e-01           0.93
694  2007  94  13.71089124 7.800057e-01           0.94
695  2007  95  14.74829637 8.049207e-01           0.95
696  2007  96  16.05703923 8.318254e-01           0.96
697  2007  97  17.82858288 8.614059e-01           0.97
698  2007  98  20.60142807 8.950175e-01           0.98
699  2007  99  26.10430188 9.352726e-01           0.99
700  2007 100 104.18033480 1.000000e+00           1.00
701  2008   1   1.96791771 3.100020e-03           0.01
702  2008   2   2.08275453 6.466135e-03           0.02
703  2008   3   2.17118688 9.998492e-03           0.03
704  2008   4   2.24391413 1.366278e-02           0.04
705  2008   5   2.30934960 1.744284e-02           0.05
706  2008   6   2.36891994 2.132570e-02           0.06
707  2008   7   2.42673259 2.530479e-02           0.07
708  2008   8   2.48187126 2.937809e-02           0.08
709  2008   9   2.53485593 3.354159e-02           0.09
710  2008  10   2.58543049 3.779023e-02           0.10
711  2008  11   2.63540123 4.212246e-02           0.11
712  2008  12   2.68484475 4.653655e-02           0.12
713  2008  13   2.73177317 5.102994e-02           0.13
714  2008  14   2.77913060 5.560229e-02           0.14
715  2008  15   2.82675959 6.025306e-02           0.15
716  2008  16   2.86973950 6.498007e-02           0.16
717  2008  17   2.91172015 6.977771e-02           0.17
718  2008  18   2.95547530 7.464522e-02           0.18
719  2008  19   2.99919509 7.958564e-02           0.19
720  2008  20   3.04085032 8.459732e-02           0.20
721  2008  21   3.08514975 8.968052e-02           0.21
722  2008  22   3.13162543 9.483782e-02           0.22
723  2008  23   3.17850369 1.000729e-01           0.23
724  2008  24   3.22405337 1.053840e-01           0.24
725  2008  25   3.26741695 1.107689e-01           0.25
726  2008  26   3.31370092 1.162290e-01           0.26
727  2008  27   3.36340032 1.217695e-01           0.27
728  2008  28   3.41094253 1.273905e-01           0.28
729  2008  29   3.45398510 1.330873e-01           0.29
730  2008  30   3.49963720 1.388580e-01           0.30
731  2008  31   3.54658680 1.447042e-01           0.31
732  2008  32   3.59486410 1.506290e-01           0.32
733  2008  33   3.64252852 1.566333e-01           0.33
734  2008  34   3.69416640 1.627199e-01           0.34
735  2008  35   3.74622301 1.688938e-01           0.35
736  2008  36   3.79553653 1.751509e-01           0.36
737  2008  37   3.84509255 1.814890e-01           0.37
738  2008  38   3.89880940 1.879150e-01           0.38
739  2008  39   3.94934647 1.944269e-01           0.39
740  2008  40   4.00364190 2.010253e-01           0.40
741  2008  41   4.06062021 2.077179e-01           0.41
742  2008  42   4.11838047 2.145046e-01           0.42
743  2008  43   4.17627542 2.213872e-01           0.43
744  2008  44   4.23430132 2.283659e-01           0.44
745  2008  45   4.28927725 2.354376e-01           0.45
746  2008  46   4.34875733 2.426026e-01           0.46
747  2008  47   4.40651583 2.498666e-01           0.47
748  2008  48   4.46368686 2.572250e-01           0.48
749  2008  49   4.52652136 2.646834e-01           0.49
750  2008  50   4.59034597 2.722488e-01           0.50
751  2008  51   4.65798768 2.799232e-01           0.51
752  2008  52   4.72516331 2.877091e-01           0.52
753  2008  53   4.79077769 2.956051e-01           0.53
754  2008  54   4.86095094 3.036129e-01           0.54
755  2008  55   4.93373281 3.117401e-01           0.55
756  2008  56   5.01048460 3.199920e-01           0.56
757  2008  57   5.08507971 3.283671e-01           0.57
758  2008  58   5.16306145 3.368667e-01           0.58
759  2008  59   5.24255340 3.454992e-01           0.59
760  2008  60   5.32575115 3.542652e-01           0.60
761  2008  61   5.41537489 3.631760e-01           0.61
762  2008  62   5.50603103 3.722362e-01           0.62
763  2008  63   5.59503741 3.814450e-01           0.63
764  2008  64   5.69513321 3.908113e-01           0.64
765  2008  65   5.78750035 4.003358e-01           0.65
766  2008  66   5.89960368 4.100325e-01           0.66
767  2008  67   6.00558237 4.199091e-01           0.67
768  2008  68   6.12175142 4.299689e-01           0.68
769  2008  69   6.23399306 4.402213e-01           0.69
770  2008  70   6.34376164 4.506594e-01           0.70
771  2008  71   6.45929980 4.612849e-01           0.71
772  2008  72   6.58396404 4.721036e-01           0.72
773  2008  73   6.71942644 4.831412e-01           0.73
774  2008  74   6.86148276 4.944074e-01           0.74
775  2008  75   6.99941389 5.059047e-01           0.75
776  2008  76   7.16260504 5.176564e-01           0.76
777  2008  77   7.32031902 5.296715e-01           0.77
778  2008  78   7.49958446 5.419757e-01           0.78
779  2008  79   7.67288006 5.545624e-01           0.79
780  2008  80   7.86580303 5.674508e-01           0.80
781  2008  81   8.05089021 5.806631e-01           0.81
782  2008  82   8.28433547 5.942105e-01           0.82
783  2008  83   8.52789242 6.081503e-01           0.83
784  2008  84   8.75454988 6.224969e-01           0.84
785  2008  85   9.01129280 6.372431e-01           0.85
786  2008  86   9.29199772 6.524276e-01           0.86
787  2008  87   9.61876942 6.681250e-01           0.87
788  2008  88   9.96833068 6.843596e-01           0.88
789  2008  89  10.36218215 7.012043e-01           0.89
790  2008  90  10.80285144 7.187409e-01           0.90
791  2008  91  11.33595360 7.371109e-01           0.91
792  2008  92  11.89534639 7.563654e-01           0.92
793  2008  93  12.58922263 7.766466e-01           0.93
794  2008  94  13.33657221 7.981335e-01           0.94
795  2008  95  14.24544192 8.209987e-01           0.95
796  2008  96  15.45432644 8.456316e-01           0.96
797  2008  97  17.22423073 8.726934e-01           0.97
798  2008  98  19.93794365 9.034323e-01           0.98
799  2008  99  25.49804100 9.405756e-01           0.99
800  2008 100 118.52763047 1.000000e+00           1.00
801  2009   1   2.55700655 3.884824e-03           0.01
802  2009   2   2.65967523 8.000639e-03           0.02
803  2009   3   2.74041911 1.225731e-02           0.03
804  2009   4   2.80495560 1.662712e-02           0.04
805  2009   5   2.86477783 2.109543e-02           0.05
806  2009   6   2.92022574 2.565323e-02           0.06
807  2009   7   2.97376710 3.029684e-02           0.07
808  2009   8   3.02330378 3.502229e-02           0.08
809  2009   9   3.07104841 3.982360e-02           0.09
810  2009  10   3.11604796 4.469840e-02           0.10
811  2009  11   3.16211890 4.964489e-02           0.11
812  2009  12   3.20611385 5.466193e-02           0.12
813  2009  13   3.25151691 5.974985e-02           0.13
814  2009  14   3.29458817 6.490662e-02           0.14
815  2009  15   3.33576963 7.013031e-02           0.15
816  2009  16   3.37665571 7.541861e-02           0.16
817  2009  17   3.41825355 8.077131e-02           0.17
818  2009  18   3.45961474 8.619016e-02           0.18
819  2009  19   3.50122915 9.167368e-02           0.19
820  2009  20   3.54278229 9.722380e-02           0.20
821  2009  21   3.58498376 1.028402e-01           0.21
822  2009  22   3.62641009 1.085211e-01           0.22
823  2009  23   3.67043423 1.142702e-01           0.23
824  2009  24   3.71413830 1.200873e-01           0.24
825  2009  25   3.75741146 1.259743e-01           0.25
826  2009  26   3.79974664 1.319275e-01           0.26
827  2009  27   3.84466673 1.379501e-01           0.27
828  2009  28   3.88959950 1.440440e-01           0.28
829  2009  29   3.93230293 1.502055e-01           0.29
830  2009  30   3.97511000 1.564336e-01           0.30
831  2009  31   4.01897847 1.627316e-01           0.31
832  2009  32   4.06369796 1.690990e-01           0.32
833  2009  33   4.11033204 1.755394e-01           0.33
834  2009  34   4.15513250 1.820498e-01           0.34
835  2009  35   4.20079615 1.886324e-01           0.35
836  2009  36   4.25052551 1.952897e-01           0.36
837  2009  37   4.29920280 2.020263e-01           0.37
838  2009  38   4.34712397 2.088380e-01           0.38
839  2009  39   4.39273330 2.157233e-01           0.39
840  2009  40   4.44560675 2.226863e-01           0.40
841  2009  41   4.49926133 2.297324e-01           0.41
842  2009  42   4.55040016 2.368618e-01           0.42
843  2009  43   4.60209411 2.440720e-01           0.43
844  2009  44   4.65395018 2.513647e-01           0.44
845  2009  45   4.70820180 2.587395e-01           0.45
846  2009  46   4.76276775 2.662001e-01           0.46
847  2009  47   4.81606747 2.737457e-01           0.47
848  2009  48   4.87651437 2.813802e-01           0.48
849  2009  49   4.93521555 2.891103e-01           0.49
850  2009  50   4.99559094 2.969340e-01           0.50
851  2009  51   5.05621723 3.048519e-01           0.51
852  2009  52   5.11630978 3.128673e-01           0.52
853  2009  53   5.17881370 3.209768e-01           0.53
854  2009  54   5.24508185 3.291890e-01           0.54
855  2009  55   5.31410371 3.375062e-01           0.55
856  2009  56   5.38747863 3.459370e-01           0.56
857  2009  57   5.45564847 3.544782e-01           0.57
858  2009  58   5.53366948 3.631358e-01           0.58
859  2009  59   5.61098073 3.719163e-01           0.59
860  2009  60   5.68421492 3.808145e-01           0.60
861  2009  61   5.75948949 3.898296e-01           0.61
862  2009  62   5.84424166 3.989708e-01           0.62
863  2009  63   5.93702536 4.082508e-01           0.63
864  2009  64   6.02720226 4.176758e-01           0.64
865  2009  65   6.12240036 4.272482e-01           0.65
866  2009  66   6.21813326 4.369725e-01           0.66
867  2009  67   6.31938496 4.468477e-01           0.67
868  2009  68   6.42015807 4.568846e-01           0.68
869  2009  69   6.52465959 4.670824e-01           0.69
870  2009  70   6.63630960 4.774470e-01           0.70
871  2009  71   6.75703336 4.879988e-01           0.71
872  2009  72   6.87674777 4.987408e-01           0.72
873  2009  73   7.00758562 5.096762e-01           0.73
874  2009  74   7.14820694 5.208256e-01           0.74
875  2009  75   7.27899859 5.321884e-01           0.75
876  2009  76   7.42898019 5.437762e-01           0.76
877  2009  77   7.57002947 5.555965e-01           0.77
878  2009  78   7.72986082 5.676483e-01           0.78
879  2009  79   7.88826226 5.799494e-01           0.79
880  2009  80   8.06704390 5.925222e-01           0.80
881  2009  81   8.25861006 6.053776e-01           0.81
882  2009  82   8.45747845 6.185454e-01           0.82
883  2009  83   8.65908342 6.320266e-01           0.83
884  2009  84   8.89832385 6.458630e-01           0.84
885  2009  85   9.17721727 6.600992e-01           0.85
886  2009  86   9.45184579 6.747757e-01           0.86
887  2009  87   9.73946598 6.898931e-01           0.87
888  2009  88  10.07001057 7.054982e-01           0.88
889  2009  89  10.45749504 7.216741e-01           0.89
890  2009  90  10.90531879 7.384991e-01           0.90
891  2009  91  11.35541659 7.560304e-01           0.91
892  2009  92  11.90581984 7.743481e-01           0.92
893  2009  93  12.51504000 7.935964e-01           0.93
894  2009  94  13.23317928 8.138590e-01           0.94
895  2009  95  14.12618256 8.354372e-01           0.95
896  2009  96  15.38404171 8.586435e-01           0.96
897  2009  97  17.04116418 8.841063e-01           0.97
898  2009  98  19.57859467 9.128685e-01           0.98
899  2009  99  24.39647071 9.468868e-01           0.99
900  2009 100 128.70877998 1.000000e+00           1.00
901  2010   1   3.10842634 4.521430e-03           0.01
902  2010   2   3.20869365 9.253829e-03           0.02
903  2010   3   3.28406830 1.411367e-02           0.03
904  2010   4   3.34946034 1.907838e-02           0.04
905  2010   5   3.40496646 2.413258e-02           0.05
906  2010   6   3.45824107 2.926879e-02           0.06
907  2010   7   3.50889212 3.448227e-02           0.07
908  2010   8   3.55718719 3.976950e-02           0.08
909  2010   9   3.60388251 4.512775e-02           0.09
910  2010  10   3.64829454 5.055364e-02           0.10
911  2010  11   3.69023781 5.604487e-02           0.11
912  2010  12   3.73338388 6.159966e-02           0.12
913  2010  13   3.77408501 6.721780e-02           0.13
914  2010  14   3.81550998 7.289678e-02           0.14
915  2010  15   3.85813597 7.863799e-02           0.15
916  2010  16   3.89947626 8.444249e-02           0.16
917  2010  17   3.93860028 9.030683e-02           0.17
918  2010  18   3.97689119 9.622979e-02           0.18
919  2010  19   4.01719966 1.022116e-01           0.19
920  2010  20   4.05571535 1.082520e-01           0.20
921  2010  21   4.09546562 1.143499e-01           0.21
922  2010  22   4.13432532 1.205077e-01           0.22
923  2010  23   4.17422564 1.267241e-01           0.23
924  2010  24   4.21356797 1.329997e-01           0.24
925  2010  25   4.25551282 1.393358e-01           0.25
926  2010  26   4.29876918 1.457368e-01           0.26
927  2010  27   4.33859350 1.521998e-01           0.27
928  2010  28   4.37891273 1.587226e-01           0.28
929  2010  29   4.41787036 1.653045e-01           0.29
930  2010  30   4.46022488 1.719456e-01           0.30
931  2010  31   4.50295082 1.786530e-01           0.31
932  2010  32   4.54795607 1.854257e-01           0.32
933  2010  33   4.59233318 1.922646e-01           0.33
934  2010  34   4.63835503 1.991712e-01           0.34
935  2010  35   4.68430737 2.061465e-01           0.35
936  2010  36   4.72823459 2.131889e-01           0.36
937  2010  37   4.77191865 2.202968e-01           0.37
938  2010  38   4.81986286 2.274743e-01           0.38
939  2010  39   4.86819988 2.347231e-01           0.39
940  2010  40   4.91573904 2.420437e-01           0.40
941  2010  41   4.96469875 2.494379e-01           0.41
942  2010  42   5.01559773 2.569045e-01           0.42
943  2010  43   5.06684069 2.644486e-01           0.43
944  2010  44   5.11850135 2.720689e-01           0.44
945  2010  45   5.17196943 2.797689e-01           0.45
946  2010  46   5.22398310 2.875465e-01           0.46
947  2010  47   5.27909012 2.954044e-01           0.47
948  2010  48   5.33695572 3.033475e-01           0.48
949  2010  49   5.39277045 3.113748e-01           0.49
950  2010  50   5.45086331 3.194886e-01           0.50
951  2010  51   5.50657366 3.276869e-01           0.51
952  2010  52   5.56757556 3.359726e-01           0.52
953  2010  53   5.62937276 3.443495e-01           0.53
954  2010  54   5.69105800 3.528196e-01           0.54
955  2010  55   5.75719220 3.613873e-01           0.55
956  2010  56   5.82192211 3.700510e-01           0.56
957  2010  57   5.88845157 3.788115e-01           0.57
958  2010  58   5.95942013 3.876773e-01           0.58
959  2010  59   6.03274338 3.966498e-01           0.59
960  2010  60   6.10730381 4.057322e-01           0.60
961  2010  61   6.17886459 4.149249e-01           0.61
962  2010  62   6.25502221 4.242276e-01           0.62
963  2010  63   6.33995877 4.336520e-01           0.63
964  2010  64   6.42291354 4.431998e-01           0.64
965  2010  65   6.51390616 4.528798e-01           0.65
966  2010  66   6.59415277 4.626879e-01           0.66
967  2010  67   6.68728499 4.726284e-01           0.67
968  2010  68   6.78897983 4.827125e-01           0.68
969  2010  69   6.88940069 4.929497e-01           0.69
970  2010  70   6.99803687 5.033407e-01           0.70
971  2010  71   7.10901066 5.138920e-01           0.71
972  2010  72   7.21459278 5.246103e-01           0.72
973  2010  73   7.33115773 5.354959e-01           0.73
974  2010  74   7.45632812 5.465555e-01           0.74
975  2010  75   7.58689402 5.578117e-01           0.75
976  2010  76   7.72575571 5.692687e-01           0.76
977  2010  77   7.87240429 5.809366e-01           0.77
978  2010  78   8.02094028 5.928227e-01           0.78
979  2010  79   8.16805007 6.049349e-01           0.79
980  2010  80   8.33155424 6.172786e-01           0.80
981  2010  81   8.51353778 6.298765e-01           0.81
982  2010  82   8.69763625 6.427544e-01           0.82
983  2010  83   8.89378519 6.559134e-01           0.83
984  2010  84   9.11814100 6.693848e-01           0.84
985  2010  85   9.35966408 6.832055e-01           0.85
986  2010  86   9.61849971 6.974023e-01           0.86
987  2010  87   9.91168542 7.120056e-01           0.87
988  2010  88  10.24274375 7.270772e-01           0.88
989  2010  89  10.58436754 7.426621e-01           0.89
990  2010  90  10.93892743 7.587709e-01           0.90
991  2010  91  11.38717779 7.754701e-01           0.91
992  2010  92  11.91218780 7.928927e-01           0.92
993  2010  93  12.46622898 8.111350e-01           0.93
994  2010  94  13.09706069 8.302595e-01           0.94
995  2010  95  13.97660559 8.504996e-01           0.95
996  2010  96  14.99277399 8.721372e-01           0.96
997  2010  97  16.48714481 8.956526e-01           0.97
998  2010  98  18.74299536 9.217797e-01           0.98
999  2010  99  23.11816617 9.527106e-01           0.99
1000 2010 100 171.48121787 1.000000e+00           1.00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Lorenz Curve Plot</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lorenz_curve_data, <span class="fu">aes</span>(<span class="at">x =</span> cum_population, <span class="at">y =</span> cum_welfare, <span class="at">color =</span> <span class="fu">as.factor</span>(year), <span class="at">group =</span> year)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Draw the Lorenz curves with a line size of 1</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>, <span class="at">direction =</span> <span class="dv">1</span>, <span class="at">option =</span> <span class="st">"C"</span>) <span class="sc">+</span>  <span class="co"># Use the viridis color scale</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Lorenz Curve by Year"</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cumulative Share of Population"</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative Share of Welfare"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Year"</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)  <span class="co"># Position the legend at the bottom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="RodrigoRTaskQuarto_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="gini-coefficient" class="level2">
<h2 class="anchored" data-anchor-id="gini-coefficient">6. Gini Coefficient</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>calculate_gini <span class="ot">&lt;-</span> <span class="cf">function</span>(income, weight) {</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure income and weight are sorted by income</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  sorted_indices <span class="ot">&lt;-</span> <span class="fu">order</span>(income)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  income <span class="ot">&lt;-</span> income[sorted_indices]</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  weight <span class="ot">&lt;-</span> weight[sorted_indices]</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cumulative weight</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  cum_weight <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(weight)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total weight</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  total_weight <span class="ot">&lt;-</span> <span class="fu">sum</span>(weight)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cumulative income</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  cum_income <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(income <span class="sc">*</span> weight)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total income</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  total_income <span class="ot">&lt;-</span> <span class="fu">sum</span>(income <span class="sc">*</span> weight)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Lorenz curve points</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  lorenz_points <span class="ot">&lt;-</span> cum_income <span class="sc">/</span> total_income</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Gini calculation</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">sum</span>((lorenz_points[<span class="sc">-</span><span class="fu">length</span>(lorenz_points)] <span class="sc">+</span> lorenz_points[<span class="sc">-</span><span class="dv">1</span>]) <span class="sc">*</span> <span class="fu">diff</span>(cum_weight)) <span class="sc">/</span> total_weight</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  gini <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> B</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(gini)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the Gini coefficient for each year</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(combined_df<span class="sc">$</span>year))</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>gini_coefficients <span class="ot">&lt;-</span> <span class="fu">sapply</span>(years, <span class="cf">function</span>(y) {</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>  data_year <span class="ot">&lt;-</span> combined_df[combined_df<span class="sc">$</span>year <span class="sc">==</span> y, ]</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate_gini</span>(data_year<span class="sc">$</span>income, data_year<span class="sc">$</span>weight)</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the years and Gini coefficients into a data frame</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>gini_coefficients_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> years, <span class="at">gini_coefficient =</span> gini_coefficients)</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>gini_coefficients_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   year gini_coefficient
1  2001        0.6829707
2  2002        0.6421103
3  2003        0.5983021
4  2004        0.5448121
5  2005        0.4890014
6  2006        0.4334923
7  2007        0.3874237
8  2008        0.3431090
9  2009        0.3058074
10 2010        0.2708267</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the Gini coefficient over the years</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gini_coefficients_df, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> gini_coefficient)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span>  <span class="co"># Connect points with lines</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>  <span class="co"># Add points</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Use a minimal theme</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gini Coefficient Over Time"</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gini Coefficient"</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="RodrigoRTaskQuarto_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>